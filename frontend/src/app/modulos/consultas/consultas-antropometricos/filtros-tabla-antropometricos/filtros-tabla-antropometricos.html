<div class="space-y-6">

  <!-- 游댳 T칤tulo del m칩dulo -->
  <div class="flex flex-col items-center text-center">
    <h2 class="text-xl font-semibold text-[#004D00]">
      CONSULTAS ANTROPOM칄TRICAS
    </h2>
    <p class="text-gray-600 font-roboto mt-1">
      Analiza tendencias de peso, IMC, circunferencias y m치s filtrando por fechas, sexo y edad.
    </p>
  </div>

  <!-- 游댲 Filtros principales -->
  <div class="bg-[#E1E1E1] p-4 sm:p-6 rounded-2xl shadow-md space-y-6">

    <!-- GRID RESPONSIVA -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

      <!-- 游릱 Fecha inicial -->
      <div class="flex flex-col items-start">
        <label class="font-oswald text-lg text-gray-800 mb-1">Fecha inicial:</label>
        <input type="date" [(ngModel)]="fechaInicio"
          class="rounded-full bg-white px-4 py-2 w-full focus:ring-2 focus:ring-[#7CE54F]" />
      </div>

      <!-- 游릱 Fecha final -->
      <div class="flex flex-col items-start">
        <label class="font-oswald text-lg text-gray-800 mb-1">Fecha final:</label>
        <input type="date" [(ngModel)]="fechaFin"
          class="rounded-full bg-white px-4 py-2 w-full focus:ring-2 focus:ring-[#7CE54F]" />
      </div>

      <!-- 游릱 Sexo -->
      <div class="flex flex-col items-start">
        <label class="font-oswald text-lg text-gray-800 mb-1">Sexo:</label>
        <select [(ngModel)]="sexoSeleccionado"
          class="rounded-full bg-white px-4 py-2 w-full focus:ring-2 focus:ring-[#7CE54F]">
          <option value="">Todos</option>
          <option value="Masculino">Masculino</option>
          <option value="Femenino">Femenino</option>
          <option value="Otro">Otro</option>
        </select>
      </div>

      <!-- 游릱 Edad m칤nima -->
      <div class="flex flex-col items-start">
        <label class="font-oswald text-lg text-gray-800 mb-1">Edad m칤nima:</label>
        <input type="number" [(ngModel)]="edadMin" min="1"
          class="rounded-full bg-white px-4 py-2 w-full focus:ring-2 focus:ring-[#7CE54F]" />
      </div>

      <!-- 游릱 Edad m치xima -->
      <div class="flex flex-col items-start">
        <label class="font-oswald text-lg text-gray-800 mb-1">Edad m치xima:</label>
        <input type="number" [(ngModel)]="edadMax" min="1"
          class="rounded-full bg-white px-4 py-2 w-full focus:ring-2 focus:ring-[#7CE54F]" />
      </div>

      <!-- 游릱 M칠trica -->
      <div class="flex flex-col items-start">
        <label class="font-oswald text-lg text-gray-800 mb-1">M칠trica:</label>
        <div>
          <select [(ngModel)]="metricaSeleccionada"
            class="rounded-full bg-white px-4 py-2 w-full focus:ring-2 focus:ring-[#7CE54F]"
            [ngClass]="{'border-red-500 border-2': mostrarError && !metricaSeleccionada}">
            <option value="">Seleccione</option>
            <option value="PESO">Peso (kg)</option>
            <option value="ALTURA">Altura (m)</option>
            <option value="IMC">IMC</option>
            <option value="PGC">Porcentaje grasa corporal</option>
            <option value="CUELLO">Circunferencia cuello</option>
            <option value="CINTURA">Circunferencia cintura</option>
            <option value="CADERA">Circunferencia cadera</option>
          </select>
          @if (mostrarError && !metricaSeleccionada) {
          <small class="text-red-500 flex  ">Campo obligatorio</small>}
        </div>

      </div>

      <!-- 游릱 Tipo de informe -->
      <div class="flex flex-col items-start lg:col-span-3">
        <label class="font-oswald text-lg text-gray-800 mb-1">Tipo de informe:</label>
        <div>
          <select [(ngModel)]="tipoInformeSeleccionado"
            class="rounded-full bg-white px-4 py-2 w-full focus:ring-2 focus:ring-[#7CE54F]"
            [ngClass]="{'border-red-500 border-2': mostrarError && !tipoInformeSeleccionado}">
            <option value="">Seleccione el tipo de informe</option>
            <option value="promedio_general">Promedio general</option>
            <option value="promedio_por_sexo">Promedio por sexo</option>
            <option value="listado_detallado">Listado detallado</option>
          </select>
          @if (mostrarError && !tipoInformeSeleccionado) {
          <small class="text-red-500 flex  ">Campo obligatorio</small>}
        </div>

      </div>

    </div>

    <!-- 游댖 Botones -->
    <div class="flex flex-wrap justify-center sm:justify-end gap-3 mt-4">
      <button (click)="consultarAntropometricos()"
        class="bg-[#004D00] text-white font-oswald px-4 py-2 rounded-full hover:bg-[#007000] transition">
        CONSULTAR
      </button>

      <button (click)="limpiarFiltros()"
        class="bg-gray-600 text-white font-oswald px-4 py-2 rounded-full hover:bg-gray-700 transition">
        LIMPIAR
      </button>
    </div>
  </div>

  <!-- 游댲 Resultados -->
  @if (resultados && resultados.length > 0) {
  <!-- TABLA PARA LISTADO DETALLADO -->
  @if (tipoInformeSeleccionado === 'listado_detallado') {
  <app-tablas-antropometricos [resultados]="resultados"></app-tablas-antropometricos>
  }

  <!-- TABLA PARA PROMEDIOS -->
  @if (tipoInformeSeleccionado !== 'listado_detallado') {
  <div class="overflow-x-auto border-4 border-zinc-400 rounded-2xl shadow-md mt-6">
    <table class="min-w-full border-collapse text-sm font-roboto">
      <thead class="bg-zinc-400 text-zinc-900 font-oswald">
        <tr class="text-center text-lg font-semibold">
          <th class="px-4 py-2">Descripci칩n</th>
          <th class="px-4 py-2">Valor</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-zinc-300">
        @for (item of resultados; track $index) {
        <tr class="text-center text-base hover:bg-[#E1E1E1] transition">
          <td class="px-4 py-2">{{ item.ETIQUETA }}</td>
          <td class="px-4 py-2 font-semibold">{{ item.VALOR }}</td>
        </tr>
        }
      </tbody>
    </table>
  </div>
  }

  <div class="mt-2 text-[#404040]">
    <p> <b>Nota:</b> La circunferencia de cadera es un par치metro que se incluye <b>SOLO</b> en las f칩rmulas de
      estimaci칩n de Porcentaje de Grasa Corporal (PGC) para las personas con sexo biol칩gico <b>FEMENINO</b> </p>
  </div>


  <div class="flex justify-end mt-4">
    <button (click)="generarInformeAntropometricos()"
      class="bg-black text-white px-6 py-2 rounded-full hover:bg-gray-800 transition font-oswald">
      GENERAR INFORME
    </button>
  </div>
  }
  @else {
  <p class="text-center text-gray-500 italic font-roboto mt-4">
    No se encontraron registros para los filtros aplicados.
  </p>
  }

</div>